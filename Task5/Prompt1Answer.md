# ÐÐ½Ð°Ð»Ð¸Ð· Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹ Ð² Ð´Ð°Ñ‚Ð°ÑÐµÑ‚Ðµ
ðŸ“Š ÐžÐ±Ñ‰Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ  
Ð’ÑÐµÐ³Ð¾ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹: 100 (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 2-101, ÑÑ‚Ñ€Ð¾ÐºÐ° 1 - Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº)  
Ð¡Ñ‚Ð¾Ð»Ð±Ñ†Ñ‹: ID, Age, Income, Purchase, City, Gender, Last_Purchase_Days, Category  
  
## 1ï¸âƒ£ ÐŸÐ ÐžÐŸÐ£Ð¡ÐšÐ˜ Ð’ Ð”ÐÐÐÐ«Ð¥  
ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ¾Ð² Ð¿Ð¾ ÑÑ‚Ð¾Ð»Ð±Ñ†Ð°Ð¼:  
Ð¡Ñ‚Ð¾Ð»Ð±ÐµÑ†	ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ¾Ð²	Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸ Ñ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ°Ð¼Ð¸  
Age	1	ÑÑ‚Ñ€Ð¾ÐºÐ° 4 (ID=3)  
Income	6	ÑÑ‚Ñ€Ð¾ÐºÐ¸ 14, 34, 54, 74, 94 (ID=13, 33, 53, 73, 93)  
Purchase	6	ÑÑ‚Ñ€Ð¾ÐºÐ¸ 8, 28, 48, 68, 88 (ID=7, 27, 47, 67, 87)  
ÐžÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑÑ‚Ð¾Ð»Ð±Ñ†Ñ‹	0	-  
Ð˜Ñ‚Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ¾Ð²: 13  

## 2ï¸âƒ£ Ð”Ð£Ð‘Ð›Ð˜ÐšÐÐ¢Ð«
ÐŸÐ¾Ð»Ð½Ñ‹Ðµ Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ñ‹ (Ð±ÐµÐ· ÑƒÑ‡ÐµÑ‚Ð° ID):  
ÐÐ°Ð¹Ð´ÐµÐ½Ð¾ 76 Ð¿Ð¾Ð»Ð½Ñ‹Ñ… Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð² (Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÑŽÑ‰Ð¸ÐµÑÑ Ð·Ð°Ð¿Ð¸ÑÐ¸)  
  
ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð³Ñ€ÑƒÐ¿Ð¿ Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð²:  
  
Ð“Ñ€ÑƒÐ¿Ð¿Ð° 1: ÑÑ‚Ñ€Ð¾ÐºÐ¸ 7, 27, 47, 67, 87 (5 Ð·Ð°Ð¿Ð¸ÑÐµÐ¹) - Moscow, Female, 90 Ð´Ð½ÐµÐ¹, Beauty, Purchase Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½  
Ð“Ñ€ÑƒÐ¿Ð¿Ð° 2: ÑÑ‚Ñ€Ð¾ÐºÐ¸ 8, 28, 48, 68, 88 (5 Ð·Ð°Ð¿Ð¸ÑÐµÐ¹) - 38 Ð»ÐµÑ‚, 950 Ð´Ð¾Ñ…Ð¾Ð´Ð°, 18000 Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ°  
Ð“Ñ€ÑƒÐ¿Ð¿Ð° 3: ÑÑ‚Ñ€Ð¾ÐºÐ¸ 6, 26, 46, 66, 86 (5 Ð·Ð°Ð¿Ð¸ÑÐµÐ¹) - 31 Ð³Ð¾Ð´, 590 Ð´Ð¾Ñ…Ð¾Ð´Ð°, 11000 Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ°  
Ð˜ Ñ‚Ð°Ðº Ð´Ð°Ð»ÐµÐµ...  
ÐŸÐ°Ñ‚Ñ‚ÐµÑ€Ð½: Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÑŽÑ‚ÑÑ Ð±Ð»Ð¾ÐºÐ°Ð¼Ð¸ - ÑÑ‚Ñ€Ð¾ÐºÐ¸ 2-21 Ð´ÑƒÐ±Ð»Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð² ÑÑ‚Ñ€Ð¾ÐºÐ°Ñ… 22-41, 42-61, 62-81, 82-101 (Ñ Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÐ¸Ð¼Ð¸ Ð²Ð°Ñ€Ð¸Ð°Ñ†Ð¸ÑÐ¼Ð¸).  
  
Ð§Ð°ÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ðµ Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ñ‹:  
ÐŸÑ€Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð²ÑÐµ Ð·Ð°Ð¿Ð¸ÑÐ¸ ÑÐ²Ð»ÑÑŽÑ‚ÑÑ Ñ‡Ð°ÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ð¼Ð¸ Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð°Ð¼Ð¸, Ñ‚Ð°Ðº ÐºÐ°Ðº Ð´Ð°Ñ‚Ð°ÑÐµÑ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ñ†Ð¸ÐºÐ»Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÑŽÑ‰Ð¸ÐµÑÑ Ð´Ð°Ð½Ð½Ñ‹Ðµ.  
  
3ï¸âƒ£ Ð’Ð«Ð‘Ð ÐžÐ¡Ð« (OUTLIERS)  
Age (Ð’Ð¾Ð·Ñ€Ð°ÑÑ‚):  
Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹: 22-47 Ð»ÐµÑ‚ (ÑÑ€ÐµÐ´Ð½ÐµÐµ ~32 Ð³Ð¾Ð´Ð°)  
  
Ð’Ñ‹Ð±Ñ€Ð¾ÑÑ‹:  
  
Ð¡Ñ‚Ñ€Ð¾ÐºÐ° 100 (ID=99): Age = 150 âŒ (Ñ„Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¸ Ð½ÐµÐ²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹Ð¹ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚)  
Ð¡Ñ‚Ñ€Ð¾ÐºÐ° 101 (ID=100): Age = 5 âŒ (Ñ€ÐµÐ±ÐµÐ½Ð¾Ðº Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ ÑÐ¾Ð²ÐµÑ€ÑˆÐ°Ñ‚ÑŒ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸)  
Income (Ð”Ð¾Ñ…Ð¾Ð´):  
Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹: 380-950 (ÑÑ€ÐµÐ´Ð½ÐµÐµ ~600)  
  
Ð’Ñ‹Ð±Ñ€Ð¾ÑÑ‹:  
  
Ð¡Ñ‚Ñ€Ð¾ÐºÐ° 100 (ID=99): Income = 1200 âš ï¸ (Ð²Ñ‹ÑˆÐµ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ð° Ð½Ð° ~26%)  
Ð¡Ñ‚Ñ€Ð¾ÐºÐ° 101 (ID=100): Income = 20 âŒ (Ð°Ð½Ð¾Ð¼Ð°Ð»ÑŒÐ½Ð¾ Ð½Ð¸Ð·ÐºÐ¸Ð¹ Ð´Ð¾Ñ…Ð¾Ð´)  
Purchase (ÐŸÐ¾ÐºÑƒÐ¿ÐºÐ°):  
Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹: 5500-25000 (ÑÑ€ÐµÐ´Ð½ÐµÐµ ~12000)  
  
Ð’Ñ‹Ð±Ñ€Ð¾ÑÑ‹:  
  
Ð¡Ñ‚Ñ€Ð¾ÐºÐ° 100 (ID=99): Purchase = 500000 âŒ (Ð² 20 Ñ€Ð°Ð· Ð²Ñ‹ÑˆÐµ Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼Ð°, ÑÐ²Ð½Ð°Ñ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ñ)  
Ð¡Ñ‚Ñ€Ð¾ÐºÐ° 101 (ID=100): Purchase = 1000 âš ï¸ (Ð½Ð¸Ð¶Ðµ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼Ð° Ð½Ð° 82%)  
Last_Purchase_Days (Ð”Ð½Ð¸ Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ¹ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸):  
Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹: 4-90 Ð´Ð½ÐµÐ¹ (ÑÑ€ÐµÐ´Ð½ÐµÐµ ~30 Ð´Ð½ÐµÐ¹)  
  
Ð’Ñ‹Ð±Ñ€Ð¾ÑÑ‹:  
  
Ð¡Ñ‚Ñ€Ð¾ÐºÐ° 100 (ID=99): Last_Purchase_Days = 1 âš ï¸ (Ð² Ð¿Ñ€ÐµÐ´ÐµÐ»Ð°Ñ… Ð½Ð¾Ñ€Ð¼Ñ‹, Ð½Ð¾ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ)  
Ð¡Ñ‚Ñ€Ð¾ÐºÐ° 101 (ID=100): Last_Purchase_Days = 999 âŒ (Ð¿Ð¾Ñ‡Ñ‚Ð¸ 3 Ð³Ð¾Ð´Ð°, ÑÐ²Ð½Ð°Ñ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ñ)  
  
## ðŸ› ï¸ Ð Ð•ÐšÐžÐœÐ•ÐÐ”ÐÐ¦Ð˜Ð˜ ÐŸÐž ÐžÐ§Ð˜Ð¡Ð¢ÐšÐ• Ð”ÐÐÐÐ«Ð¥  
1. ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ¾Ð²  
Age (1 Ð¿Ñ€Ð¾Ð¿ÑƒÑÐº):  
### ÐœÐµÑ‚Ð¾Ð´ 1: Ð—Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¼ÐµÐ´Ð¸Ð°Ð½Ð¾Ð¹ (Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ)  
df['Age'].fillna(df['Age'].median(), inplace=True)  
  
### ÐœÐµÑ‚Ð¾Ð´ 2: Ð—Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ ÑÑ€ÐµÐ´Ð½Ð¸Ð¼ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸ÐµÐ¼  
df['Age'].fillna(df['Age'].mean(), inplace=True)  
  
### ÐœÐµÑ‚Ð¾Ð´ 3: Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚Ñ€Ð¾ÐºÐ¸ (ÐµÑÐ»Ð¸ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ð¾)  
df.dropna(subset=['Age'], inplace=True)  
Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¼ÐµÐ´Ð¸Ð°Ð½Ñƒ (32-33 Ð³Ð¾Ð´Ð°), Ñ‚Ð°Ðº ÐºÐ°Ðº Ð¾Ð½Ð° ÑƒÑÑ‚Ð¾Ð¹Ñ‡Ð¸Ð²Ð° Ðº Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ°Ð¼.  
  
Income (6 Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ¾Ð²):  
### ÐœÐµÑ‚Ð¾Ð´ 1: Ð—Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¼ÐµÐ´Ð¸Ð°Ð½Ð¾Ð¹ Ð¿Ð¾ Ð³Ñ€ÑƒÐ¿Ð¿Ð°Ð¼ (Ð»ÑƒÑ‡ÑˆÐ¸Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´)  
df['Income'] = df.groupby(['City', 'Gender'])['Income'].transform(  
    lambda x: x.fillna(x.median())  
)  
  
# ÐœÐµÑ‚Ð¾Ð´ 3: Ð—Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¾Ð±Ñ‰ÐµÐ¹ Ð¼ÐµÐ´Ð¸Ð°Ð½Ð¾Ð¹  
df['Income'].fillna(df['Income'].median(), inplace=True)  
  
### ÐœÐµÑ‚Ð¾Ð´ 3: ÐŸÑ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· Ñ€ÐµÐ³Ñ€ÐµÑÑÐ¸ÑŽ  
from sklearn.linear_model import LinearRegression  

### ÐžÐ±ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð½Ð° Age, Purchase Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ñ Income  
Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ: Ð“Ñ€ÑƒÐ¿Ð¿Ð¾Ð²Ð°Ñ Ð¼ÐµÐ´Ð¸Ð°Ð½Ð° Ð¿Ð¾ City Ð¸ Gender, Ñ‚Ð°Ðº ÐºÐ°Ðº Ð´Ð¾Ñ…Ð¾Ð´ Ð·Ð°Ð²Ð¸ÑÐ¸Ñ‚ Ð¾Ñ‚ Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¸.  
  
Purchase (6 Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ¾Ð²):    
### ÐœÐµÑ‚Ð¾Ð´ 1: Ð—Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¼ÐµÐ´Ð¸Ð°Ð½Ð¾Ð¹ Ð¿Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸
df['Purchase'] = df.groupby('Category')['Purchase'].transform(
    lambda x: x.fillna(x.median())
)
  
### ÐœÐµÑ‚Ð¾Ð´ 2: ÐŸÑ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ðµ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Income
### Purchase Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ ÐºÐ¾Ñ€Ñ€ÐµÐ»Ð¸Ñ€ÑƒÐµÑ‚ Ñ Ð´Ð¾Ñ…Ð¾Ð´Ð¾Ð¼
Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ: ÐœÐµÐ´Ð¸Ð°Ð½Ð° Ð¿Ð¾ Category, Ñ‚Ð°Ðº ÐºÐ°Ðº Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸ Ð·Ð°Ð²Ð¸ÑÑÑ‚ Ð¾Ñ‚ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ñ‚Ð¾Ð²Ð°Ñ€Ð°.
  
2. ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð²  
### Ð¨Ð°Ð³ 1: Ð˜Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ Ð¿Ð¾Ð»Ð½Ñ‹Ñ… Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð² (Ð±ÐµÐ· ID)
duplicates = df.duplicated(subset=df.columns.difference(['ID']), keep='first')
print(f"ÐÐ°Ð¹Ð´ÐµÐ½Ð¾ Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð²: {duplicates.sum()}")

### Ð¨Ð°Ð³ 2: Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð² (Ð¾ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿ÐµÑ€Ð²Ð¾Ðµ Ð²Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ)
df_clean = df.drop_duplicates(
    subset=df.columns.difference(['ID']), 
    keep='first'
)

### Ð¨Ð°Ð³ 3: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ‡Ð°ÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ñ… Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð² (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)
### ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²Ñ‹Ðµ City, Gender, Category, Ð½Ð¾ Ñ€Ð°Ð·Ð½Ñ‹Ðµ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸
partial_dups = df.duplicated(subset=['City', 'Gender', 'Category'], keep=False)
Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ:

Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð²ÑÐµ Ð¿Ð¾Ð»Ð½Ñ‹Ðµ Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ñ‹, Ð¾ÑÑ‚Ð°Ð²Ð¸Ð² Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿ÐµÑ€Ð²Ð¾Ðµ Ð²Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ  
Ð­Ñ‚Ð¾ ÑÐ¾ÐºÑ€Ð°Ñ‚Ð¸Ñ‚ Ð´Ð°Ñ‚Ð°ÑÐµÑ‚ Ñ 100 Ð´Ð¾ ~24 ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð·Ð°Ð¿Ð¸ÑÐµÐ¹  
ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð±Ð¸Ð·Ð½ÐµÑ-Ð»Ð¾Ð³Ð¸ÐºÑƒ: Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾, Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ñ‹ - ÑÑ‚Ð¾ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ñ‹Ðµ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸ Ð¾Ð´Ð½Ð¸Ñ… ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð²  
3. ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ¾Ð²  
ÐœÐµÑ‚Ð¾Ð´ 1: IQR (Interquartile Range) - ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´  
def remove_outliers_iqr(df, column):  
    Q1 = df[column].quantile(0.25)  
    Q3 = df[column].quantile(0.75)  
    IQR = Q3 - Q1  
    lower_bound = Q1 - 1.5 * IQR  
    upper_bound = Q3 + 1.5 * IQR  
    return df[(df[column] >= lower_bound) & (df[column] <= upper_bound)]  
  
### ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ  
df_clean = remove_outliers_iqr(df, 'Age')  
df_clean = remove_outliers_iqr(df_clean, 'Income')  
df_clean = remove_outliers_iqr(df_clean, 'Purchase')  
df_clean = remove_outliers_iqr(df_clean, 'Last_Purchase_Days')  
ÐœÐµÑ‚Ð¾Ð´ 2: Z-score (Ð´Ð»Ñ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ)  
from scipy import stats  
import numpy as np  
  
def remove_outliers_zscore(df, column, threshold=3):  
    z_scores = np.abs(stats.zscore(df[column].dropna()))  
    return df[(z_scores < threshold)]  
ÐœÐµÑ‚Ð¾Ð´ 3: Ð‘Ð¸Ð·Ð½ÐµÑ-Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° (Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ð´Ð°Ñ‚Ð°ÑÐµÑ‚Ð°)  
# Age: Ð´Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ñ‹Ð¹ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½ 18-100 Ð»ÐµÑ‚  
df = df[(df['Age'] >= 18) & (df['Age'] <= 100)]  

# Income: Ð´Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ñ‹Ð¹ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½ 100-2000  
df = df[(df['Income'] >= 100) & (df['Income'] <= 2000)]  
  
# Purchase: Ð´Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ñ‹Ð¹ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½ 1000-50000  
df = df[(df['Purchase'] >= 1000) & (df['Purchase'] <= 50000)]  
  
# Last_Purchase_Days: Ð´Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ñ‹Ð¹ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½ 1-365 Ð´Ð½ÐµÐ¹  
df = df[(df['Last_Purchase_Days'] >= 1) & (df['Last_Purchase_Days'] <= 365)]  
Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ñ… Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ¾Ð²:  
  
ID=99 (Age=150, Purchase=500000): âŒ Ð£Ð”ÐÐ›Ð˜Ð¢Ð¬ - ÑÐ²Ð½Ð¾ Ð¾ÑˆÐ¸Ð±Ð¾Ñ‡Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ  
ID=100 (Age=5, Income=20, Last_Purchase_Days=999): âŒ Ð£Ð”ÐÐ›Ð˜Ð¢Ð¬ - Ð½ÐµÑ€ÐµÐ°Ð»Ð¸ÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ  
ðŸ“‹ Ð˜Ð¢ÐžÐ“ÐžÐ’Ð«Ð™ PIPELINE ÐžÐ§Ð˜Ð¡Ð¢ÐšÐ˜  
import pandas as pd  
import numpy as np  
  
# 1. Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…  
df = pd.read_csv('dataset.csv')  
  
# 2. Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÐ²Ð½Ñ‹Ñ… Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹ (ID=99, 100)  
df = df[~df['ID'].isin([99, 100])]  
  
# 3. Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»Ð½Ñ‹Ñ… Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð²  
df = df.drop_duplicates(subset=df.columns.difference(['ID']), keep='first')  
  
# 4. Ð—Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ¾Ð²  
df['Age'].fillna(df['Age'].median(), inplace=True)  
df['Income'] = df.groupby(['City', 'Gender'])['Income'].transform(  
    lambda x: x.fillna(x.median())  
)  
df['Purchase'] = df.groupby('Category')['Purchase'].transform(  
    lambda x: x.fillna(x.median())  
)  

# 5. Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ¾Ð² Ð¿Ð¾ Ð±Ð¸Ð·Ð½ÐµÑ-Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼  
df = df[  
    (df['Age'] >= 18) & (df['Age'] <= 100) &  
    (df['Income'] >= 100) & (df['Income'] <= 2000) &  
    (df['Purchase'] >= 1000) & (df['Purchase'] <= 50000) &  
    (df['Last_Purchase_Days'] >= 1) & (df['Last_Purchase_Days'] <= 365)  
]  

# 6. Ð¡Ð±Ñ€Ð¾Ñ Ð¸Ð½Ð´ÐµÐºÑÐ¾Ð²  
df.reset_index(drop=True, inplace=True)  
  
# 7. Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð¾Ñ‡Ð¸Ñ‰ÐµÐ½Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…  
df.to_csv('dataset_cleaned.csv', index=False)  
  
print(f"Ð˜ÑÑ…Ð¾Ð´Ð½Ñ‹Ñ… Ð·Ð°Ð¿Ð¸ÑÐµÐ¹: 100")  
print(f"ÐžÑ‡Ð¸Ñ‰ÐµÐ½Ð½Ñ‹Ñ… Ð·Ð°Ð¿Ð¸ÑÐµÐ¹: {len(df)}")  
print(f"Ð£Ð´Ð°Ð»ÐµÐ½Ð¾ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹: {100 - len(df)}")  
ÐžÐ¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ~20-24 Ñ‡Ð¸ÑÑ‚Ñ‹Ñ… ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð±ÐµÐ· Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹.  
  
ðŸ“ˆ Ð’Ð˜Ð—Ð£ÐÐ›Ð˜Ð—ÐÐ¦Ð˜Ð¯ ÐÐÐžÐœÐÐ›Ð˜Ð™  
import matplotlib.pyplot as plt  
import seaborn as sns  
  
# Boxplot Ð´Ð»Ñ Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ¾Ð²  
fig, axes = plt.subplots(2, 2, figsize=(12, 10))  
  
sns.boxplot(data=df, y='Age', ax=axes[0,0])  
axes[0,0].set_title('Age - Ð’Ñ‹Ð±Ñ€Ð¾ÑÑ‹')  
  
sns.boxplot(data=df, y='Income', ax=axes[0,1])  
axes[0,1].set_title('Income - Ð’Ñ‹Ð±Ñ€Ð¾ÑÑ‹')  
  
sns.boxplot(data=df, y='Purchase', ax=axes[1,0])  
axes[1,0].set_title('Purchase - Ð’Ñ‹Ð±Ñ€Ð¾ÑÑ‹')  
  
sns.boxplot(data=df, y='Last_Purchase_Days', ax=axes[1,1])  
axes[1,1].set_title('Last_Purchase_Days - Ð’Ñ‹Ð±Ñ€Ð¾ÑÑ‹')  
  
plt.tight_layout()  
plt.show()  
ÐÐ½Ð°Ð»Ð¸Ð· Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½. Ð”Ð°Ñ‚Ð°ÑÐµÑ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ 13 Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ¾Ð², 76 Ð¿Ð¾Ð»Ð½Ñ‹Ñ… Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð² Ð¸ 2 Ð·Ð°Ð¿Ð¸ÑÐ¸ Ñ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ°Ð¼Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ.  
